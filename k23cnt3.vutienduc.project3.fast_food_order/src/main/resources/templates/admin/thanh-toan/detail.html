<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/_LayoutAdmin :: layout(
            title='Chi ti·∫øt thanh to√°n',
            headerTitle='Chi ti·∫øt Thanh to√°n',
            content=~{::content},
            customStyles=~{::styles},
            customScripts=~{::scripts}
      )}">

<head>
    <th:block th:fragment="styles">
        <style>
            body {
                background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%);
            }

            /* Card Container */
            .detail-card {
                border-radius: 20px;
                background: white;
                box-shadow: 0 10px 40px rgba(245, 158, 11, 0.15);
                max-width: 900px;
                margin: 0 auto 2rem auto;
                overflow: hidden;
            }

            /* Header */
            .detail-header {
                background: linear-gradient(135deg, #F59E0B, #FBBF24);
                padding: 2rem;
                color: white;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .detail-header h4 {
                margin: 0;
                font-size: 1.8rem;
                font-weight: 700;
            }

            .btn-back {
                background: white;
                color: #F59E0B;
                padding: 0.7rem 1.5rem;
                border-radius: 10px;
                text-decoration: none;
                font-weight: 600;
                transition: all 0.3s;
            }

            .btn-back:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(255,255,255,0.3);
            }

            /* Card Body */
            .detail-body {
                padding: 2.5rem;
            }

            /* Status Badge */
            .status-badge {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.8rem 1.5rem;
                border-radius: 12px;
                font-weight: 700;
                font-size: 1.1rem;
                margin-bottom: 2rem;
            }

            .status-completed {
                background: linear-gradient(135deg, #10B981, #34D399);
                color: white;
            }

            .status-pending {
                background: linear-gradient(135deg, #F59E0B, #FBBF24);
                color: white;
            }

            .status-failed {
                background: linear-gradient(135deg, #EF4444, #DC2626);
                color: white;
            }

            /* Info Grid */
            .info-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 1.5rem;
                margin-bottom: 2rem;
            }

            .info-box {
                background: linear-gradient(135deg, #FFF7ED, #FFEDD5);
                padding: 1.5rem;
                border-radius: 12px;
                border: 2px solid #FED7AA;
                transition: all 0.3s;
            }

            .info-box:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 20px rgba(245, 158, 11, 0.2);
            }

            .info-label {
                font-size: 0.9rem;
                color: #92400E;
                font-weight: 600;
                margin-bottom: 0.5rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .info-value {
                font-size: 1.3rem;
                color: #78350F;
                font-weight: 700;
            }

            /* Payment Method Box */
            .payment-method {
                background: linear-gradient(135deg, #EFF6FF, #DBEAFE);
                padding: 1.5rem;
                border-radius: 12px;
                border: 2px solid #93C5FD;
                text-align: center;
                margin-bottom: 2rem;
            }

            .payment-method .icon {
                font-size: 3rem;
                margin-bottom: 0.5rem;
            }

            .payment-method .method-name {
                font-size: 1.2rem;
                font-weight: 700;
                color: #1E40AF;
            }

            /* Timeline */
            .timeline {
                background: #F9FAFB;
                padding: 1.5rem;
                border-radius: 12px;
                border-left: 4px solid #F59E0B;
            }

            .timeline-item {
                display: flex;
                align-items: center;
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .timeline-item:last-child {
                margin-bottom: 0;
            }

            .timeline-icon {
                width: 40px;
                height: 40px;
                background: linear-gradient(135deg, #F59E0B, #FBBF24);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 1.2rem;
            }

            .timeline-content {
                flex: 1;
            }

            .timeline-label {
                font-weight: 600;
                color: #374151;
                font-size: 0.9rem;
            }

            .timeline-value {
                color: #6B7280;
                font-size: 1rem;
            }

            /* Action Buttons */
            .action-section {
                display: flex;
                gap: 1rem;
                justify-content: center;
                padding-top: 2rem;
                border-top: 2px solid #F3F4F6;
                margin-top: 2rem;
            }

            .btn-action {
                padding: 0.8rem 2rem;
                border-radius: 12px;
                font-weight: 600;
                text-decoration: none;
                transition: all 0.3s;
                border: none;
                font-size: 1rem;
            }

            .btn-primary {
                background: linear-gradient(135deg, #3B82F6, #60A5FA);
                color: white;
            }

            .btn-primary:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            }

            .btn-danger {
                background: linear-gradient(135deg, #EF4444, #DC2626);
                color: white;
            }

            .btn-danger:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
            }

            /* Alert Box */
            .alert-info {
                background: #EFF6FF;
                border-left: 4px solid #3B82F6;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                margin-bottom: 2rem;
                color: #1E40AF;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .detail-header {
                    flex-direction: column;
                    gap: 1rem;
                    text-align: center;
                }

                .info-grid {
                    grid-template-columns: 1fr;
                }

                .action-section {
                    flex-direction: column;
                }
            }
        </style>
    </th:block>
</head>

<body>
<section th:fragment="content">
    <div class="detail-card">

        <!-- Header -->
        <div class="detail-header">
            <h4>üìÑ Chi ti·∫øt Thanh To√°n</h4>
            <a th:href="@{/admin/thanh-toan}" class="btn-back">
                <i class="bi bi-arrow-left"></i> Quay l·∫°i danh s√°ch
            </a>
        </div>

        <!-- Body -->
        <div class="detail-body">

            <!-- Status Badge -->
            <div class="text-center mb-4">
                <span class="status-badge"
                      th:classappend="${thanhToan.trangThai == 'ƒê√£ thanh to√°n' ? 'status-completed' :
                                      (thanhToan.trangThai == 'Ch·ªù thanh to√°n' ? 'status-pending' : 'status-failed')}">
                    <span th:if="${thanhToan.trangThai == 'ƒê√£ thanh to√°n'}">‚úÖ</span>
                    <span th:if="${thanhToan.trangThai == 'Ch·ªù thanh to√°n'}">‚è≥</span>
                    <span th:if="${thanhToan.trangThai == 'Th·∫•t b·∫°i'}">‚ùå</span>
                    <span th:text="${thanhToan.trangThai}"></span>
                </span>
            </div>

            <!-- Alert Info -->
            <div class="alert-info">
                <i class="bi bi-info-circle-fill"></i>
                <strong>Th√¥ng tin:</strong> ƒê√¢y l√† th√¥ng tin chi ti·∫øt c·ªßa giao d·ªãch thanh to√°n.
                Vui l√≤ng ki·ªÉm tra k·ªπ tr∆∞·ªõc khi th·ª±c hi·ªán b·∫•t k·ª≥ thao t√°c n√†o.
            </div>

            <!-- Info Grid -->
            <div class="info-grid">
                <!-- M√£ thanh to√°n -->
                <div class="info-box">
                    <div class="info-label">
                        <i class="bi bi-hash"></i> M√£ thanh to√°n
                    </div>
                    <div class="info-value" th:text="'#TT' + ${thanhToan.id}"></div>
                </div>

                <!-- M√£ ƒë∆°n h√†ng -->
                <div class="info-box">
                    <div class="info-label">
                        <i class="bi bi-receipt"></i> M√£ ƒë∆°n h√†ng
                    </div>
                    <div class="info-value">
                        <a th:href="@{'/admin/don-hang/detail/' + ${thanhToan.donHangId}}"
                           style="color: #3B82F6; text-decoration: none;"
                           th:text="'#ƒêH' + ${thanhToan.donHangId}"></a>
                    </div>
                </div>

                <!-- S·ªë ti·ªÅn -->
                <div class="info-box" style="grid-column: span 2;">
                    <div class="info-label">
                        <i class="bi bi-cash-stack"></i> S·ªë ti·ªÅn thanh to√°n
                    </div>
                    <div class="info-value" style="color: #10B981; font-size: 2rem;"
                         th:text="${#numbers.formatDecimal(thanhToan.soTien, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"></div>
                </div>
            </div>

            <!-- Payment Method -->
            <div class="payment-method">
                <div class="icon" th:if="${thanhToan.phuongThuc == 'ONLINE'}">üí≥</div>
                <div class="icon" th:if="${thanhToan.phuongThuc == 'COD'}">üíµ</div>
                <div class="method-name">
                    <span th:if="${thanhToan.phuongThuc == 'ONLINE'}">Thanh to√°n Online Banking</span>
                    <span th:if="${thanhToan.phuongThuc == 'COD'}">Thanh to√°n COD (Ti·ªÅn m·∫∑t)</span>
                </div>
            </div>

            <!-- Timeline -->
            <div class="timeline">
                <h6 style="font-weight: 700; margin-bottom: 1rem; color: #374151;">
                    <i class="bi bi-clock-history"></i> Th·ªùi gian
                </h6>

                <div class="timeline-item" th:if="${thanhToan.ngayThanhToan != null}">
                    <div class="timeline-icon">
                        <i class="bi bi-calendar-check"></i>
                    </div>
                    <div class="timeline-content">
                        <div class="timeline-label">Ng√†y thanh to√°n</div>
                        <div class="timeline-value"
                             th:text="${#temporals.format(thanhToan.ngayThanhToan, 'dd/MM/yyyy HH:mm:ss')}"></div>
                    </div>
                </div>

                <div class="timeline-item" th:if="${thanhToan.ngayThanhToan == null}">
                    <div class="timeline-icon" style="background: #9CA3AF;">
                        <i class="bi bi-calendar-x"></i>
                    </div>
                    <div class="timeline-content">
                        <div class="timeline-label">Ng√†y thanh to√°n</div>
                        <div class="timeline-value" style="color: #EF4444; font-weight: 600;">Ch∆∞a thanh to√°n</div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="action-section">
                <a th:href="@{'/admin/don-hang/detail/' + ${thanhToan.donHangId}}" class="btn-action btn-primary">
                    <i class="bi bi-box-arrow-up-right"></i> Xem ƒë∆°n h√†ng
                </a>
                <button type="button" class="btn-action btn-danger"
                        th:onclick="'confirmDelete(' + ${thanhToan.id} + ')'">
                    <i class="bi bi-trash"></i> X√≥a thanh to√°n
                </button>
            </div>

        </div>
    </div>
</section>

<th:block th:fragment="scripts">
    <script>
        console.log("üìÑ Loaded: Chi ti·∫øt thanh to√°n");

        function confirmDelete(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a thanh to√°n #TT' + id + '? Thao t√°c n√†y kh√¥ng th·ªÉ ho√†n t√°c!')) {
                window.location.href = '/admin/thanh-toan/delete/' + id;
            }
        }

        // Animation khi load
        document.addEventListener('DOMContentLoaded', function() {
            const boxes = document.querySelectorAll('.info-box, .payment-method, .timeline');
            boxes.forEach((box, index) => {
                setTimeout(() => {
                    box.style.opacity = '0';
                    box.style.transform = 'translateY(20px)';
                    box.style.transition = 'all 0.4s ease';
                    setTimeout(() => {
                        box.style.opacity = '1';
                        box.style.transform = 'translateY(0)';
                    }, 50);
                }, index * 100);
            });
        });
    </script>
</th:block>
</body>
</html>