<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi"
      th:replace="~{fragments/_LayoutUser :: layout(
            title='Thanh to√°n',
            content=~{::content},
            customStyles=~{::customStyles},
            customScripts=~{::customScripts}
      )}">

<!-- =========================== CUSTOM STYLES =========================== -->
<th:block th:fragment="customStyles">
    <style>
        .order-card {
            border: 1px solid #e5e7eb;
            border-radius: 14px;
            padding: 16px 20px;
            margin-bottom: 16px;
            transition: all 0.2s ease;
            background: #fff;
        }

        .order-card:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .order-meta {
            font-size: 14px;
            color: #6b7280;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
        }

        .order-total {
            font-size: 18px;
            font-weight: 600;
            color: #dc2626;
        }
    </style>
</th:block>


<!-- =========================== CONTENT =========================== -->
<th:block th:fragment="content">
    <div class="container py-4">
        <h3 class="mb-4">üì¶ ƒê∆°n h√†ng c·ªßa t√¥i</h3>

        <div th:if="${#lists.isEmpty(donHangs)}" class="alert alert-info">
            B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.
        </div>

        <div th:each="dh : ${donHangs}" class="order-card">

            <!-- HEADER -->
            <div class="order-header">
                <div>
                    <strong>ƒê∆°n h√†ng #<span th:text="${dh.id}"></span></strong>
                    <div class="order-meta"
                         th:text="${#temporals.format(dh.ngayDat, 'dd/MM/yyyy HH:mm')}">
                    </div>
                </div>

                <!-- TR·∫†NG TH√ÅI ƒê∆†N -->
                <div>
                    <span class="badge bg-warning text-dark"
                          th:if="${dh.trangThai.name() == 'CHO_XU_LY'}">Ch·ªù x·ª≠ l√Ω</span>
                    <span class="badge bg-primary"
                          th:if="${dh.trangThai.name() == 'DANG_GIAO'}">ƒêang giao</span>
                    <span class="badge bg-success"
                          th:if="${dh.trangThai.name() == 'DA_GIAO'}">ƒê√£ giao</span>
                    <span class="badge bg-danger"
                          th:if="${dh.trangThai.name() == 'DA_HUY'}">ƒê√£ h·ªßy</span>
                </div>
            </div>

            <!-- BODY -->
            <div class="d-flex gap-2 mb-2">
                <!-- TR·∫†NG TH√ÅI THANH TO√ÅN -->
                <span class="badge bg-danger"
                      th:if="${dh.thanhToan.trangThai == 'CHUA_THANH_TOAN'}">
                    Ch∆∞a thanh to√°n
                </span>
                <span class="badge bg-success"
                      th:if="${dh.thanhToan.trangThai == 'DA_THANH_TOAN'}">
                    ƒê√£ thanh to√°n
                </span>
            </div>

            <!-- FOOTER -->
            <div class="order-footer">
                <div class="order-total"
                     th:text="${#numbers.formatDecimal(dh.thanhToan.soTien, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">
                </div>

                <div class="d-flex gap-2">
                    <!-- ‚úÖ CHI TI·∫æT ƒê∆†N -->
                    <a th:href="@{/orders/{id}(id=${dh.id})}"
                       class="btn btn-outline-primary btn-sm">
                        Chi ti·∫øt
                    </a>

                    <!-- ‚ùå N√öT H·ª¶Y ƒê∆†N -->
                    <form th:if="${dh.trangThai.name() == 'CHO_XU_LY'}"
                          th:action="@{/orders/{id}/cancel(id=${dh.id})}"
                          method="post"
                          onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n h√†ng n√†y?');">
                        <button type="submit" class="btn btn-outline-danger btn-sm">
                            H·ªßy ƒë∆°n
                        </button>
                    </form>
                </div>
            </div>
        </div>


            <!-- =========================== CUSTOM SCRIPTS =========================== -->
<th:block th:fragment="customScripts">
    <!-- Hi·ªán t·∫°i ch∆∞a c·∫ßn JS ri√™ng -->
</th:block>

</html>
