<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi"
      th:replace="~{fragments/_LayoutUser :: layout(
            title='Trang chủ - Food Lover',
            content=~{::content},
            customStyles=~{::styles},
            customScripts=~{::scripts}
      )}">

<head>
    <th:block th:fragment="styles">
        <style>
            /* Hero Section */
            .hero-section {
                background: linear-gradient(135deg, var(--dark-bg) 0%, #2d2d2d 100%);
                color: white;
                padding: 100px 0;
                position: relative;
                overflow: hidden;
            }

            .hero-section::before {
                content: '';
                position: absolute;
                top: -50%;
                right: -10%;
                width: 600px;
                height: 600px;
                background: var(--primary-color);
                border-radius: 50%;
                opacity: 0.1;
                animation: float 6s ease-in-out infinite;
            }

            @keyframes float {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-30px); }
            }

            .hero-content h1 {
                font-size: 3.5rem;
                font-weight: bold;
                margin-bottom: 20px;
                animation: fadeInUp 1s ease;
            }

            .hero-content .highlight {
                color: var(--primary-color);
            }

            .hero-content p {
                font-size: 1.2rem;
                margin-bottom: 30px;
                opacity: 0.9;
                animation: fadeInUp 1s ease 0.2s backwards;
            }

            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .hero-image {
                position: relative;
                z-index: 2;
                animation: fadeInRight 1s ease;
            }

            @keyframes fadeInRight {
                from {
                    opacity: 0;
                    transform: translateX(50px);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }

            .hero-image img {
                width: 100%;
                max-width: 500px;
                filter: drop-shadow(0 20px 40px rgba(0,0,0,0.5));
                animation: bounce-img 3s ease-in-out infinite;
            }

            @keyframes bounce-img {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-20px); }
            }

            /* Category Section */
            .category-section {
                padding: 80px 0;
                background: #f8f9fa;
            }

            .section-title {
                text-align: center;
                margin-bottom: 50px;
            }

            .section-title h2 {
                font-size: 2.5rem;
                font-weight: bold;
                color: var(--dark-bg);
                margin-bottom: 10px;
            }

            .section-title .highlight {
                color: var(--primary-color);
            }

            .section-title p {
                color: #666;
                font-size: 1.1rem;
            }

            .category-card {
                background: white;
                border-radius: 15px;
                padding: 30px;
                text-align: center;
                transition: all 0.3s;
                box-shadow: 0 5px 15px rgba(0,0,0,0.08);
                cursor: pointer;
                margin-bottom: 30px;
                height: 100%;
            }

            .category-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            }

            .category-card i {
                font-size: 3rem;
                color: var(--primary-color);
                margin-bottom: 15px;
            }

            .category-card h5 {
                font-weight: bold;
                color: var(--dark-bg);
                margin-bottom: 10px;
            }

            .category-card p {
                color: #666;
                margin: 0;
            }

            /* Best Selling Items */
            .best-selling {
                padding: 80px 0;
                background: white;
            }

            .food-card {
                background: white;
                border-radius: 20px;
                overflow: hidden;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                transition: all 0.3s;
                margin-bottom: 30px;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            .food-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            }

            .food-image {
                position: relative;
                overflow: hidden;
                height: 250px;
            }

            .food-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.5s;
            }

            .food-card:hover .food-image img {
                transform: scale(1.1);
            }

            .food-badge {
                position: absolute;
                top: 15px;
                right: 15px;
                background: var(--primary-color);
                color: white;
                padding: 5px 15px;
                border-radius: 20px;
                font-size: 0.85rem;
                font-weight: bold;
            }

            .food-content {
                padding: 20px;
                flex: 1;
                display: flex;
                flex-direction: column;
            }

            .food-title {
                font-size: 1.3rem;
                font-weight: bold;
                color: var(--dark-bg);
                margin-bottom: 10px;
            }

            .food-desc {
                color: #666;
                font-size: 0.9rem;
                margin-bottom: 15px;
                flex: 1;
            }

            .food-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: auto;
            }

            .food-price {
                font-size: 1.5rem;
                font-weight: bold;
                color: var(--primary-color);
            }

            .btn-add-cart {
                background: var(--primary-color);
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 25px;
                font-weight: bold;
                transition: all 0.3s;
                cursor: pointer;
            }

            .btn-add-cart:hover {
                background: var(--secondary-color);
                transform: scale(1.05);
            }

            /* Features Section */
            .features-section {
                padding: 80px 0;
                background: linear-gradient(135deg, var(--dark-bg) 0%, #2d2d2d 100%);
                color: white;
            }

            .feature-box {
                text-align: center;
                padding: 30px;
            }

            .feature-box i {
                font-size: 3.5rem;
                color: var(--primary-color);
                margin-bottom: 20px;
            }

            .feature-box h4 {
                font-weight: bold;
                margin-bottom: 15px;
            }

            .feature-box p {
                opacity: 0.8;
                margin: 0;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .hero-content h1 {
                    font-size: 2rem;
                }

                .hero-section {
                    padding: 60px 0;
                }

                .section-title h2 {
                    font-size: 1.8rem;
                }

                .hero-image img {
                    max-width: 300px;
                }
            }
        </style>
    </th:block>
</head>

<body>
<th:block th:fragment="content">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 hero-content">
                    <h1>Điểm Đến Của Bạn Cho Món Ăn <span class="highlight">Nhanh & Ngon!</span></h1>
                    <p>Thưởng thức những món ăn được chế biến từ nguyên liệu tươi ngon nhất. Đặt hàng ngay và nhận ưu đãi hấp dẫn!</p>
                    <a th:href="@{/mon-an}" class="btn btn-order btn-lg">
                        <i class="bi bi-rocket-takeoff-fill"></i> Đặt Hàng Ngay
                    </a>
                </div>
                <div class="col-lg-6 hero-image text-center">
                    <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=600" alt="Delicious Burger">
                </div>
            </div>
        </div>
    </section>

    <!-- Category Section -->
    <section class="category-section">
        <div class="container">
            <div class="section-title">
                <h2>Danh Mục <span class="highlight">Món Ăn</span></h2>
                <p>Khám phá đa dạng các loại món ăn yêu thích</p>
            </div>

            <div class="row">
                <!-- Burger -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <a th:href="@{/mon-an(theLoaiId=${1})}" class="text-decoration-none text-dark">
                        <div class="category-card">
                            <i class="bi bi-egg-fried"></i>
                            <h5>Burger</h5>
                            <p>Thơm ngon, đậm đà</p>
                        </div>
                    </a>
                </div>

                <!-- Pizza -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <a th:href="@{/mon-an(theLoaiId=${2})}" class="text-decoration-none text-dark">
                        <div class="category-card">
                            <i class="bi bi-cup-hot-fill"></i>
                            <h5>Pizza</h5>
                            <p>Nóng hổi, phô mai tan chảy</p>
                        </div>
                    </a>
                </div>

                <!-- Gà Rán -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <a th:href="@{/mon-an(theLoaiId=${3})}" class="text-decoration-none text-dark">
                        <div class="category-card">
                            <i class="bi bi-basket2-fill"></i>
                            <h5>Gà Rán</h5>
                            <p>Giòn rụm, đậm vị</p>
                        </div>
                    </a>
                </div>

                <!-- Đồ Uống -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <a th:href="@{/mon-an(theLoaiId=${4})}" class="text-decoration-none text-dark">
                        <div class="category-card">
                            <i class="bi bi-cup-straw"></i>
                            <h5>Đồ Uống</h5>
                            <p>Mát lạnh, sảng khoái</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Best Selling Items -->
    <section class="best-selling" id="menu">
        <div class="container">
            <div class="section-title">
                <h2>Món Ăn <span class="highlight">Bán Chạy</span></h2>
                <p>Những món ăn được yêu thích nhất tại cửa hàng</p>
            </div>

            <div class="row">
                <div class="col-lg-3 col-md-6" th:each="monAn : ${monAnList}">
                    <!-- LINK TO DETAIL -->
                    <a th:href="@{/mon-an/{id}(id=${monAn.id})}" style="text-decoration: none; color: inherit;">
                        <div class="food-card">
                            <!-- ẢNH MÓN ĂN -->
                            <div class="food-image">
                                <img th:src="${monAn.hinhAnh != null && monAn.hinhAnh.size() > 0
                                                  ? monAn.hinhAnh[0]
                                                  : 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400'}"
                                     th:alt="${monAn.ten}">
                                <span class="food-badge">Hot</span>
                            </div>

                            <div class="food-content">
                                <!-- TÊN MÓN -->
                                <h5 class="food-title" th:text="${monAn.ten}">
                                    Tên món ăn
                                </h5>

                                <!-- MÔ TẢ -->
                                <p class="food-desc" th:text="${monAn.moTa}">
                                    Mô tả món ăn
                                </p>

                                <div class="food-footer">
                                    <!-- GIÁ -->
                                    <span class="food-price"
                                          th:text="${#numbers.formatDecimal(monAn.gia, 0, 'COMMA', 0, 'POINT')} + '₫'">
                                            50.000₫
                                        </span>

                                    <!-- NÚT ADD CART -->
                                    <button class="btn-add-cart"
                                            th:onclick="'addToCart(' + ${monAn.id} + '); return false;'">
                                        <i class="bi bi-cart-plus-fill"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </a>
                    <!-- END LINK -->
                </div>
            </div>

            <div class="text-center mt-4">
                <a th:href="@{/mon-an}" class="btn btn-order btn-lg">
                    Xem Tất Cả Món <i class="bi bi-arrow-right"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="feature-box">
                        <i class="bi bi-lightning-charge-fill"></i>
                        <h4>Giao Hàng Nhanh</h4>
                        <p>Giao hàng trong vòng 30 phút, đảm bảo món ăn còn nóng</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-box">
                        <i class="bi bi-award-fill"></i>
                        <h4>Chất Lượng Đảm Bảo</h4>
                        <p>Nguyên liệu tươi ngon, quy trình chế biến chuẩn HACCP</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-box">
                        <i class="bi bi-headset"></i>
                        <h4>Hỗ Trợ 24/7</h4>
                        <p>Đội ngũ hỗ trợ khách hàng luôn sẵn sàng phục vụ bạn</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</th:block>

<th:block th:fragment="scripts">
    <script>
        // Add to cart function
        function addToCart(monAnId) {
            // Check if user is logged in
            const isLoggedIn = /*[[${nguoiDung != null}]]*/ false;

            if (!isLoggedIn) {
                alert('Vui lòng đăng nhập để thêm món vào giỏ hàng!');
                window.location.href = '/login';
                return;
            }

            // Implement add to cart functionality
            fetch('/api/cart/add/' + monAnId, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Đã thêm món vào giỏ hàng!');
                    // Update cart count
                    const cartBadge = document.querySelector('.badge-count');
                    if (cartBadge) {
                        cartBadge.textContent = parseInt(cartBadge.textContent || 0) + 1;
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Có lỗi xảy ra. Vui lòng thử lại!');
            });
        }
    </script>
</th:block>
</body>
</html>